# Программный макет для обнаружения аномальной сетевой активности на хосте

## Описание проекта
Данная программа автоматически собирает сетевой трафик, обрабатывает его и выявляет аномалии с помощью модели Isolation Forest.

## Этапы
- **Сбор сетевого трафика в виде пакетов**: использование `scapy` для захвата пакетов в реальном времени.
- **Оцифровка и предобработка данных**: создание новых признаков и преобразование данных в удобный формат.
- **Обучение модели/Загрузка модели**: Использование Isolation Forest для обнаружения аномалий.
- **Обнаружение аномалий**: Анализ поступающих данных и выявление отклонений.
- **Логирование**: Запись обнаруженных аномалий в лог-файл.

## Установка и запуск
### Требования
Установите следующие библиотеки Python3:

```sh
pip install scapy pandas numpy scikit-learn joblib
```

### Запуск
Запустите скрипт:

```sh
python anomaly_detection.py
```

По дефолту программа собирает трафик в течение 86400 секунд (24 часа), обучает модель или использует уже обученную модель и выявляет аномалии.

## Результаты тестирования
### Пример обнаружения аномалии
В ходе тестирования программа обнаружила следующие аномальные соединения:

```
Anomaly detected - Timestamp: 2025-02-27 20:48:05.660573184, Src IP: 192.168.1.254, Dst IP: 192.168.1.255, Length: 229
Anomaly detected - Timestamp: 2025-02-27 20:48:30.045286144, Src IP: 192.168.1.73, Dst IP: 239.255.255.250, Length: 217
Anomaly detected - Timestamp: 2025-02-27 20:48:30.677136896, Src IP: 192.168.1.87, Dst IP: 192.168.1.73, Length: 539
Anomaly detected - Timestamp: 2025-02-27 20:48:31.046355712, Src IP: 192.168.1.73, Dst IP: 239.255.255.250, Length: 217
Anomaly detected - Timestamp: 2025-02-27 20:48:31.784974592, Src IP: 192.168.1.87, Dst IP: 192.168.1.73, Length: 539
Anomaly detected - Timestamp: 2025-02-27 20:48:32.047729152, Src IP: 192.168.1.73, Dst IP: 239.255.255.250, Length: 217
Anomaly detected - Timestamp: 2025-02-27 20:48:32.599647744, Src IP: 192.168.1.87, Dst IP: 192.168.1.73, Length: 539
Anomaly detected - Timestamp: 2025-02-27 20:48:33.048100864, Src IP: 192.168.1.73, Dst IP: 239.255.255.250, Length: 217
Anomaly detected - Timestamp: 2025-02-27 20:48:33.366467840, Src IP: 192.168.1.87, Dst IP: 192.168.1.73, Length: 539
Anomaly detected - Timestamp: 2025-02-27 20:48:36.687451904, Src IP: 192.168.1.254, Dst IP: 192.168.1.255, Length: 229
Anomaly detected - Timestamp: 2025-02-27 20:49:07.639152384, Src IP: 192.168.1.254, Dst IP: 192.168.1.255, Length: 229
Anomaly detected - Timestamp: 2025-02-27 20:49:38.744846848, Src IP: 192.168.1.254, Dst IP: 192.168.1.255, Length: 229
```

Эти аномалии были записаны в файл `anomaly_report_example.log`.

## Заключение
Программа позволяет эффективно анализировать сетевой трафик и выявлять подозрительные активности. Возможны дальнейшие улучшения, такие как настройка порога чувствительности модели или интеграция с системами оповещений.

